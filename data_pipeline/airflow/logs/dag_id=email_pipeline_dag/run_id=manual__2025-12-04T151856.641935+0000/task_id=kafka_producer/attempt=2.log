[2025-12-04T15:32:41.161+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: email_pipeline_dag.kafka_producer manual__2025-12-04T15:18:56.641935+00:00 [queued]>
[2025-12-04T15:32:41.201+0000] {taskinstance.py:1956} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: email_pipeline_dag.kafka_producer manual__2025-12-04T15:18:56.641935+00:00 [queued]>
[2025-12-04T15:32:41.204+0000] {taskinstance.py:2170} INFO - Starting attempt 2 of 2
[2025-12-04T15:32:41.255+0000] {taskinstance.py:2191} INFO - Executing <Task(BashOperator): kafka_producer> on 2025-12-04 15:18:56.641935+00:00
[2025-12-04T15:32:41.274+0000] {standard_task_runner.py:60} INFO - Started process 417 to run task
[2025-12-04T15:32:41.317+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'email_pipeline_dag', 'kafka_producer', 'manual__2025-12-04T15:18:56.641935+00:00', '--job-id', '76', '--raw', '--subdir', 'DAGS_FOLDER/email_pipeline_dag.py', '--cfg-path', '/tmp/tmpbvasraku']
[2025-12-04T15:32:41.344+0000] {standard_task_runner.py:88} INFO - Job 76: Subtask kafka_producer
[2025-12-04T15:32:41.961+0000] {task_command.py:423} INFO - Running <TaskInstance: email_pipeline_dag.kafka_producer manual__2025-12-04T15:18:56.641935+00:00 [running]> on host 17d26709f247
[2025-12-04T15:32:42.850+0000] {taskinstance.py:2480} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='email_pipeline_dag' AIRFLOW_CTX_TASK_ID='kafka_producer' AIRFLOW_CTX_EXECUTION_DATE='2025-12-04T15:18:56.641935+00:00' AIRFLOW_CTX_TRY_NUMBER='2' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-12-04T15:18:56.641935+00:00'
[2025-12-04T15:32:42.852+0000] {subprocess.py:63} INFO - Tmp dir root location: /tmp
[2025-12-04T15:32:42.855+0000] {subprocess.py:75} INFO - Running command: ['/usr/bin/bash', '-c', 'python /opt/***/kafka/Producer/email_producer.py']
[2025-12-04T15:32:42.957+0000] {subprocess.py:86} INFO - Output:
[2025-12-04T15:32:46.901+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:46,900 - __main__ - INFO - üöÄ Starting Producer + Consumer...
[2025-12-04T15:32:46.907+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:46,901 - __main__ - INFO - üîê Authenticating with Gmail API...
[2025-12-04T15:32:46.993+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:46,992 - googleapiclient.discovery_cache - INFO - file_cache is only supported with oauth2client<4.0.0
[2025-12-04T15:32:47.010+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,009 - __main__ - INFO - üì® Connecting to Kafka...
[2025-12-04T15:32:47.042+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,041 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.20.0.4', 29092)]>: connecting to kafka:29092 [('172.20.0.4', 29092) IPv4]
[2025-12-04T15:32:47.067+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,064 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.20.0.4', 29092)]>: Broker version identified as 2.6
[2025-12-04T15:32:47.082+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,065 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.20.0.4', 29092)]>: Connection complete.
[2025-12-04T15:32:47.113+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,110 - __main__ - INFO - üé¨ D√©marrage du visualiseur temps r√©el...
[2025-12-04T15:32:47.121+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,121 - __main__ - INFO - ‚úì Consumer thread started
[2025-12-04T15:32:47.129+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,128 - __main__ - INFO - üìß Fetching recent emails...
[2025-12-04T15:32:47.150+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,127 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=bootstrap-0 host=kafka:29092 <connecting> [IPv4 ('172.20.0.4', 29092)]>: connecting to kafka:29092 [('172.20.0.4', 29092) IPv4]
[2025-12-04T15:32:47.188+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,178 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=bootstrap-0 host=kafka:29092 <checking_api_versions_recv> [IPv4 ('172.20.0.4', 29092)]>: Broker version identified as 2.6
[2025-12-04T15:32:47.192+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,184 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.20.0.4', 29092)]>: Connection complete.
[2025-12-04T15:32:47.208+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,188 - kafka.consumer.subscription_state - INFO - Updating subscribed topics to: ('emails-topic',)
[2025-12-04T15:32:47.238+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,238 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.20.0.4', 29092)]>: connecting to kafka:29092 [('172.20.0.4', 29092) IPv4]
[2025-12-04T15:32:47.240+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,239 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.20.0.4', 29092)]>: Connection complete.
[2025-12-04T15:32:47.243+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,240 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.20.0.4', 29092)]>: Closing connection.
[2025-12-04T15:32:47.356+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,355 - kafka.cluster - INFO - Coordinator for group/unified-viewer is BrokerMetadata(nodeId='coordinator-1', host='kafka', port=29092, rack=None)
[2025-12-04T15:32:47.357+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,356 - kafka.coordinator - INFO - Discovered coordinator coordinator-1 for group unified-viewer
[2025-12-04T15:32:47.358+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,356 - kafka.coordinator.heartbeat - INFO - Starting new heartbeat thread
[2025-12-04T15:32:47.360+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,357 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group unified-viewer
[2025-12-04T15:32:47.363+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,358 - kafka.coordinator - INFO - Failed to join group unified-viewer: NodeNotReadyError: coordinator-1
[2025-12-04T15:32:47.366+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,363 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=coordinator-1 host=kafka:29092 <connecting> [IPv4 ('172.20.0.4', 29092)]>: connecting to kafka:29092 [('172.20.0.4', 29092) IPv4]
[2025-12-04T15:32:47.370+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,364 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-2.3.0, node_id=coordinator-1 host=kafka:29092 <connected> [IPv4 ('172.20.0.4', 29092)]>: Connection complete.
[2025-12-04T15:32:47.465+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,465 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:32:47.470+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,469 - kafka.coordinator - INFO - Received member id kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d for group unified-viewer; will retry join-group
[2025-12-04T15:32:47.471+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,470 - kafka.coordinator - INFO - Failed to join group unified-viewer: [Error 79] MemberIdRequiredError
[2025-12-04T15:32:47.472+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:47,470 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:32:48.370+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:48,369 - __main__ - INFO - Found 10 emails in last 24 hours
[2025-12-04T15:32:49.354+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:49,354 - kafka.coordinator - INFO - Successfully joined group unified-viewer <Generation 5 (member_id: kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d, protocol: range)>
[2025-12-04T15:32:49.384+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:49,383 - kafka.consumer.subscription_state - INFO - Updated partition assignment: []
[2025-12-04T15:32:49.389+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:49,384 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions set() for group unified-viewer
[2025-12-04T15:32:50.948+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:50,947 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connecting> [IPv4 ('172.20.0.4', 29092)]>: connecting to kafka:29092 [('172.20.0.4', 29092) IPv4]
[2025-12-04T15:32:50.949+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:50,948 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=1 host=kafka:29092 <connected> [IPv4 ('172.20.0.4', 29092)]>: Connection complete.
[2025-12-04T15:32:50.950+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:50,948 - kafka.conn - INFO - <BrokerConnection client_id=kafka-python-producer-1, node_id=bootstrap-0 host=kafka:29092 <connected> [IPv4 ('172.20.0.4', 29092)]>: Closing connection.
[2025-12-04T15:32:51.033+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,033 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 33
[2025-12-04T15:32:51.041+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,041 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 34
[2025-12-04T15:32:51.051+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,050 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 35
[2025-12-04T15:32:51.073+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,073 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 38
[2025-12-04T15:32:51.086+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,085 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 40
[2025-12-04T15:32:51.101+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,100 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 42
[2025-12-04T15:32:51.124+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,122 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 44
[2025-12-04T15:32:51.155+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,146 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 48
[2025-12-04T15:32:51.168+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,167 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 52
[2025-12-04T15:32:51.175+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,175 - __main__ - INFO - ‚úì Email sent to Kafka - Offset: 56
[2025-12-04T15:32:51.179+0000] {subprocess.py:93} INFO - 2025-12-04 15:32:51,175 - __main__ - INFO - ‚úÖ Successfully sent 10 emails to Kafka
[2025-12-04T15:34:25.536+0000] {subprocess.py:93} INFO - 2025-12-04 15:34:25,535 - kafka.coordinator.heartbeat - WARNING - Heartbeat failed for group unified-viewer because it is rebalancing
[2025-12-04T15:34:25.539+0000] {subprocess.py:93} INFO - 2025-12-04 15:34:25,536 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group unified-viewer
[2025-12-04T15:34:25.540+0000] {subprocess.py:93} INFO - 2025-12-04 15:34:25,536 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:34:25.741+0000] {subprocess.py:93} INFO - 2025-12-04 15:34:25,741 - kafka.coordinator - INFO - Successfully joined group unified-viewer <Generation 6 (member_id: kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d, protocol: range)>
[2025-12-04T15:34:25.758+0000] {subprocess.py:93} INFO - 2025-12-04 15:34:25,757 - kafka.consumer.subscription_state - INFO - Updated partition assignment: []
[2025-12-04T15:34:25.760+0000] {subprocess.py:93} INFO - 2025-12-04 15:34:25,757 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions set() for group unified-viewer
[2025-12-04T15:36:38.178+0000] {subprocess.py:93} INFO - 2025-12-04 15:36:38,165 - kafka.coordinator.heartbeat - WARNING - Heartbeat failed for group unified-viewer because it is rebalancing
[2025-12-04T15:36:38.199+0000] {subprocess.py:93} INFO - 2025-12-04 15:36:38,169 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group unified-viewer
[2025-12-04T15:36:38.200+0000] {subprocess.py:93} INFO - 2025-12-04 15:36:38,169 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:36:38.413+0000] {subprocess.py:93} INFO - 2025-12-04 15:36:38,413 - kafka.coordinator - INFO - Successfully joined group unified-viewer <Generation 7 (member_id: kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d, protocol: range)>
[2025-12-04T15:36:38.449+0000] {subprocess.py:93} INFO - 2025-12-04 15:36:38,448 - kafka.consumer.subscription_state - INFO - Updated partition assignment: []
[2025-12-04T15:36:38.451+0000] {subprocess.py:93} INFO - 2025-12-04 15:36:38,448 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions set() for group unified-viewer
[2025-12-04T15:38:08.948+0000] {subprocess.py:93} INFO - 2025-12-04 15:38:08,946 - kafka.coordinator.heartbeat - WARNING - Heartbeat failed for group unified-viewer because it is rebalancing
[2025-12-04T15:38:08.956+0000] {subprocess.py:93} INFO - 2025-12-04 15:38:08,948 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group unified-viewer
[2025-12-04T15:38:08.958+0000] {subprocess.py:93} INFO - 2025-12-04 15:38:08,948 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:38:08.971+0000] {subprocess.py:93} INFO - 2025-12-04 15:38:08,970 - kafka.coordinator - INFO - Successfully joined group unified-viewer <Generation 8 (member_id: kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d, protocol: range)>
[2025-12-04T15:38:08.983+0000] {subprocess.py:93} INFO - 2025-12-04 15:38:08,982 - kafka.consumer.subscription_state - INFO - Updated partition assignment: []
[2025-12-04T15:38:08.986+0000] {subprocess.py:93} INFO - 2025-12-04 15:38:08,982 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions set() for group unified-viewer
[2025-12-04T15:46:40.402+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:40,384 - kafka.coordinator.heartbeat - WARNING - Heartbeat session expired, marking coordinator dead
[2025-12-04T15:46:40.454+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:40,391 - kafka.coordinator - WARNING - Marking the coordinator dead (node coordinator-1) for group unified-viewer: Heartbeat session expired.
[2025-12-04T15:46:40.463+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:40,395 - kafka.cluster - INFO - Coordinator for group/unified-viewer is BrokerMetadata(nodeId='coordinator-1', host='kafka', port=29092, rack=None)
[2025-12-04T15:46:40.464+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:40,396 - kafka.coordinator - INFO - Discovered coordinator coordinator-1 for group unified-viewer
[2025-12-04T15:46:55.444+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:55,442 - kafka.coordinator.heartbeat - WARNING - Heartbeat failed for group unified-viewer because it is rebalancing
[2025-12-04T15:46:55.446+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:55,445 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group unified-viewer
[2025-12-04T15:46:55.447+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:55,446 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:46:58.516+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:58,505 - kafka.coordinator - INFO - Successfully joined group unified-viewer <Generation 9 (member_id: kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d, protocol: range)>
[2025-12-04T15:46:58.547+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:58,544 - kafka.consumer.subscription_state - INFO - Updated partition assignment: []
[2025-12-04T15:46:58.550+0000] {subprocess.py:93} INFO - 2025-12-04 15:46:58,546 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions set() for group unified-viewer
[2025-12-04T15:49:10.814+0000] {subprocess.py:93} INFO - 2025-12-04 15:49:10,805 - kafka.coordinator.heartbeat - WARNING - Heartbeat failed for group unified-viewer because it is rebalancing
[2025-12-04T15:49:10.816+0000] {subprocess.py:93} INFO - 2025-12-04 15:49:10,813 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group unified-viewer
[2025-12-04T15:49:10.818+0000] {subprocess.py:93} INFO - 2025-12-04 15:49:10,814 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:49:11.055+0000] {subprocess.py:93} INFO - 2025-12-04 15:49:11,054 - kafka.coordinator - INFO - Successfully joined group unified-viewer <Generation 10 (member_id: kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d, protocol: range)>
[2025-12-04T15:49:11.066+0000] {subprocess.py:93} INFO - 2025-12-04 15:49:11,065 - kafka.consumer.subscription_state - INFO - Updated partition assignment: []
[2025-12-04T15:49:11.069+0000] {subprocess.py:93} INFO - 2025-12-04 15:49:11,066 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions set() for group unified-viewer
[2025-12-04T15:50:38.463+0000] {subprocess.py:93} INFO - 2025-12-04 15:50:38,459 - kafka.coordinator.heartbeat - WARNING - Heartbeat failed for group unified-viewer because it is rebalancing
[2025-12-04T15:50:38.471+0000] {subprocess.py:93} INFO - 2025-12-04 15:50:38,460 - kafka.coordinator.consumer - INFO - Revoking previously assigned partitions set() for group unified-viewer
[2025-12-04T15:50:38.472+0000] {subprocess.py:93} INFO - 2025-12-04 15:50:38,462 - kafka.coordinator - INFO - (Re-)joining group unified-viewer
[2025-12-04T15:50:38.621+0000] {subprocess.py:93} INFO - 2025-12-04 15:50:38,619 - kafka.coordinator - INFO - Successfully joined group unified-viewer <Generation 11 (member_id: kafka-python-2.3.0-5292ea1e-c2d0-4965-9844-86f6602dff3d, protocol: range)>
[2025-12-04T15:50:38.635+0000] {subprocess.py:93} INFO - 2025-12-04 15:50:38,634 - kafka.consumer.subscription_state - INFO - Updated partition assignment: []
[2025-12-04T15:50:38.637+0000] {subprocess.py:93} INFO - 2025-12-04 15:50:38,634 - kafka.coordinator.consumer - INFO - Setting newly assigned partitions set() for group unified-viewer
